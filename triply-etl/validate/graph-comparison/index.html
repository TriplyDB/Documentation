<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="The official documentation for the Triply products: TriplyDB, TriplyDB.js, and TriplyETL." name="description"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Graph Comparison - Triply Documentation</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="../../../css/intellij-light.css" rel="stylesheet"/>
<link href="../../../css/triply.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Graph Comparison";
        var mkdocs_page_input_path = "triply-etl/validate/graph-comparison.md";
        var mkdocs_page_url = null;
      </script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Triply Documentation
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
</li>
</ul>
<p class="caption"><span class="caption-text">TriplyDB</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#">Getting started</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../triply-db-getting-started/">Overview</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triply-db-getting-started/uploading-data/">Uploading Data</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triply-db-getting-started/editing-data/">Editing (SKOS) Data</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triply-db-getting-started/publishing-data/">Sharing Data</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triply-db-getting-started/viewing-data/">Viewing Data</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triply-db-getting-started/exporting-data/">Exporting Data</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triply-db-getting-started/saved-queries/">Saved Queries</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triply-db-getting-started/data-stories/">Data Stories</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triply-db-getting-started/admin-settings-pages/">Admin Settings Pages</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triply-db-getting-started/reference/">Reference</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../triply-api/">API</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">TriplyDB-JS</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/">Overview</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/app/">App</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/account/">Account</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/asset/">Asset</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/dataset/">Dataset</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/graph/">Graph</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/organization/">Organization</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/query/">Query</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/service/">Service</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/story/">Story</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/user/">User</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../triplydb-js/faq/">FAQ</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../triply-cli/">Command-line Interface</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../triplydb-changelog/">Changelog</a>
</li>
</ul>
<p class="caption"><span class="caption-text">TriplyETL</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="#">Generic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../">Overview</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../generic/getting-started/">Getting Started</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../generic/changelog/">Changelog</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../generic/cli/">Command Line Interface (CLI)</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../generic/declarations/">Declarations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../generic/control-structures/">Control Structures</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../generic/debug/">Debug</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../generic/internal-store/">Internal Store</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../generic/maintenance/">Maintenance</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../generic/record/">Record</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../generic/vocabularies/">Vocabularies</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Sources</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../sources/">Overview</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sources/apis/">APIs</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sources/inline-json/">Inline JSON</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sources/inline-strings/">Inline Strings</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sources/local-files/">Local Files</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sources/online-files/">Online Files</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sources/rml/">RML Sources</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sources/triplydb-assets/">TriplyDB Assets</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sources/triplydb-datasets/">TriplyDB Datasets</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sources/triplydb-queries/">TriplyDB Queries</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Extract</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../extract/">Overview</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extract/csv/">CSV</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extract/json/">JSON</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extract/oai-pmh/">OAI-PMH</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extract/postgres/">Postgres</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extract/rdf/">RDF</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extract/shapefile/">Shapefile</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extract/tsv/">TSV</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extract/xlsx/">XLSX</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../extract/xml/">XML</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Transform</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../transform/">Overview</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../transform/ratt/">RATT</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../transform/rml/">RML</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../transform/typescript/">TypeScript</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../transform/xslt/">XSLT</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Assert</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../assert/">Overview</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../assert/json-ld/">JSON-LD</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#">RATT</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="../../assert/ratt/terms/">RATT Terms</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../assert/ratt/statements/">RATT Statements</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../assert/rml/">RML</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../assert/xslt/">XSLT</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#">Enrich</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../enrich/">Overview</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="#">SHACL</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="../../enrich/shacl/">Overview</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../enrich/shacl/triple-rules/">Triple Rules</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../enrich/shacl/sparql-rules/">SPARQL Rules</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#">SPARQL</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="../../enrich/sparql/construct/">SPARQL Construct</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../enrich/sparql/update/">SPARQL Update</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="#">Validate</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../">Overview</a>
</li>
<li class="toctree-l2 current"><a class="reference internal current" href="./">Graph Comparison</a>
<ul class="current">
<li class="toctree-l3"><a class="reference internal" href="#graph-comparison-failure">Graph comparison failure</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#graph-comparison-success">Graph comparison success</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#graph-comparison-for-validation">Graph comparison for validation</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#step-1-identify-representative-records">Step 1: Identify representative records</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#step-2-manually-create-linked-data">Step 2: Manually create linked data</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#step-3-implement-the-etl">Step 3: Implement the ETL</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#step-4-call-the-graph-comparison-function">Step 4. Call the graph comparison function</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#full-script">Full script</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#options">Options</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#see-also">See also</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../shacl/">SHACL</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../publish/">Publish</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Yasgui</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../yasgui/">Introduction</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../yasgui-api/">For Developers</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Triply Documentation</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">TriplyETL</li>
<li class="breadcrumb-item">Validate</li>
<li class="breadcrumb-item active">Graph Comparison</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<div class="toc"><span class="toctitle">On this page:</span><ul>
<li><a href="#graph-comparison">Graph Comparison</a><ul>
<li><a href="#graph-comparison-failure">Graph comparison failure</a></li>
<li><a href="#graph-comparison-success">Graph comparison success</a></li>
<li><a href="#graph-comparison-for-validation">Graph comparison for validation</a><ul>
<li><a href="#step-1-identify-representative-records">Step 1: Identify representative records</a></li>
<li><a href="#step-2-manually-create-linked-data">Step 2: Manually create linked data</a></li>
<li><a href="#step-3-implement-the-etl">Step 3: Implement the ETL</a></li>
<li><a href="#step-4-call-the-graph-comparison-function">Step 4. Call the graph comparison function</a></li>
<li><a href="#full-script">Full script</a></li>
</ul>
</li>
<li><a href="#options">Options</a></li>
<li><a href="#see-also">See also</a></li>
</ul>
</li>
</ul>
</div>
<h1 id="graph-comparison">Graph Comparison<a class="headerlink" href="#graph-comparison" title="Permanent link">¶</a></h1>
<p>Graph comparison is an approach for validating that the data produced by TriplyETL is identical to one or more manually specified graphs.</p>
<h2 id="graph-comparison-failure">Graph comparison failure<a class="headerlink" href="#graph-comparison-failure" title="Permanent link">¶</a></h2>
<p>The following full TriplyETL script shows how graph comparison failure is detected in TriplyETL:</p>
<pre><code class="language-ts">import { compareGraphs, Etl, loadRdf, Source } from '@triplyetl/etl/generic'

export default async function (): Promise&lt;Etl&gt; {
  const etl = new Etl()
  etl.use(
    loadRdf(Source.string(`[]&lt;p&gt;&lt;o&gt;.`)),
    compareGraphs(Source.string(`[]&lt;p&gt;&lt;o&gt;. []&lt;p&gt;&lt;o&gt;.`)),
  )
  return etl
}
</code></pre>
<p>Function <code>loadRdf()</code> loads the following linked data into the Internal Store:</p>
<div class="mermaid">graph LR
  _:1 -- p --&gt; o.
</div>
<p>Function <code>compareGraphs()</code> compares the contents of the Internal Store to the following linked data:</p>
<div class="mermaid">graph LR
  _:2a -- p --&gt; o.
  _:2b -- p --&gt; o.
</div>
<p>Notice that these two graphs are not isomorphic: It is possible to map <code>_:2a</code> and <code>_:2b</code> onto <code>_:1</code>, but it is not possible to map <code>_:1</code> onto both <code>_:2a</code> and <code>_:2b</code>. As a result, graph comparison will fail and the ETL will be halted.</p>
<h2 id="graph-comparison-success">Graph comparison success<a class="headerlink" href="#graph-comparison-success" title="Permanent link">¶</a></h2>
<p>The following full TriplyETL script shows how graph comparison success is detected in TriplyETL:</p>
<pre><code class="language-ts">import { compareGraphs, Etl, loadRdf, Source } from '@triplyetl/etl/generic'

export default async function (): Promise&lt;Etl&gt; {
  const etl = new Etl()
  etl.use(
    loadRdf(Source.string(`&lt;s&gt;&lt;p&gt;&lt;o&gt;.`)),
    compareGraphs(Source.string(`&lt;s&gt;&lt;p&gt;&lt;o&gt;. &lt;s&gt;&lt;p&gt;&lt;o&gt;.`)),
  )
  return etl
}
</code></pre>
<p>This example is similar to the previous example, but uses names for the subject terms (<code>&lt;s&gt;</code>). Because of this, graph comparison now succeeds.</p>
<h2 id="graph-comparison-for-validation">Graph comparison for validation<a class="headerlink" href="#graph-comparison-for-validation" title="Permanent link">¶</a></h2>
<p>The two examples that were given before illustrate how graph comparison works. But they do not show how graph comparison can be used as a validation approach in TriplyETL pipelines. In order to do so, the following steps must be followed:</p>
<ol>
<li><strong>Identify representative records.</strong> Select a limited number of records from your data sources that together are representative for the full data source systems. This often includes typical records, where all/most expected data items are included, as well as atypical records that are uncommon but valid. There must be reasonable confidence that an ETL that produces the correct results for these selected records, will also produce correct results for all other records.</li>
<li><strong>Create target linked data.</strong> For the representative records identified in step 1, manually create the linked data that the ETL should generate for them. The manually created linked data must be included in the ETL repository, for example by including various TriG files.</li>
<li><strong>Implement the ETL.</strong> The ETL configuration must be implemented in a generic way that works for all records. Any of the supported ETL configuration languages can be used for this: JSON-LD, RATT, RML, SHACL, SPARQL, or XSLT.</li>
<li><strong>Call the graph comparison function.</strong> After the ETL has been performed for a specific record, call the graph comparison function to validate whether the linked data in the Internal Store is isomorphic to the linked data that was manually specified.</li>
</ol>
<h3 id="step-1-identify-representative-records">Step 1: Identify representative records<a class="headerlink" href="#step-1-identify-representative-records" title="Permanent link">¶</a></h3>
<p>To keep our example simple, we use a data source with three simple JSON records:</p>
<pre><code class="language-ts">fromJson([
  { id: '1', price: 15 },
  { id: '2', price: 12 },
  { color: 'red', id: '3', price: 16 },
]),
</code></pre>
<p>We choose records 1 and 3 as the representative ones. Together these two records use all properties that occur in the source data. These records also allow us to test whether the optional color property is handled correctly.</p>
<h3 id="step-2-manually-create-linked-data">Step 2: Manually create linked data<a class="headerlink" href="#step-2-manually-create-linked-data" title="Permanent link">¶</a></h3>
<p>For each record selected in Step 1, we create the linked data that must be generated by TriplyETL:</p>
<pre><code class="language-turtle">prefix sdo: &lt;https://schema.org/&gt;
[] sdo:value 15.
</code></pre>
<p>and:</p>
<pre><code class="language-turtle">prefix sdo: &lt;https://schema.org/&gt;
[] sdo:color 'red';
   sdo:value 16.
</code></pre>
<h3 id="step-3-implement-the-etl">Step 3: Implement the ETL<a class="headerlink" href="#step-3-implement-the-etl" title="Permanent link">¶</a></h3>
<p>We use RATT to implement the assertions:</p>
<pre><code class="language-ts">addSkolemIri({ key: '_product' }),
triple('_product', sdo.price, 'price'),
when('width', triple('_product', sdo.color, 'color')),
</code></pre>
<h3 id="step-4-call-the-graph-comparison-function">Step 4. Call the graph comparison function<a class="headerlink" href="#step-4-call-the-graph-comparison-function" title="Permanent link">¶</a></h3>
<p>Since comparison graphs must be created by hand, only a small number of records will have a corresponding comparison graph. The graph comparison call must therefore only be performed for some records. We use the switch control structure to determine whether a record is eligible for graph comparison.</p>
<h3 id="full-script">Full script<a class="headerlink" href="#full-script" title="Permanent link">¶</a></h3>
<p>By completing the 4 steps, we end up with the following full TriplyETL script that applies graph comparison to a limited number of representative records:</p>
<pre><code class="language-ts">import { _switch, compareGraphs, Etl, fromJson, Source, when } from '@triplyetl/etl/generic'
import { addSkolemIri, triple } from '@triplyetl/etl/ratt'
import { sdo } from '@triplyetl/vocabularies'

export default async function (): Promise&lt;Etl&gt; {
  const etl = new Etl()
  etl.use(
    fromJson([
      { id: '1', price: 15 },
      { id: '2', price: 12 },
      { color: 'red', id: '3', price: 16 },
    ]),
    addSkolemIri({ key: '_product' }),
    triple('_product', sdo.price, 'price'),
    when('width', triple('_product', sdo.color, 'color')),
    _switch('id',
      ['1', compareGraphs(Source.string(`
              prefix sdo: &lt;https://schema.org/&gt;
              [] sdo:value 15.`))],
      ['3', compareGraphs(Source.string(`
              prefix sdo: &lt;https://schema.org/&gt;
              [] sdo:color 'red';
                 sdo:value 16.`))],
    ),
  )
  return etl
}
</code></pre>
<p>This script succeeds, since the linked data generated by the ETL is isomorphic to the manually specified data.</p>
<h2 id="options">Options<a class="headerlink" href="#options" title="Permanent link">¶</a></h2>
<ul>
<li>
<p><code>contentType</code> specifies the RDF format in which the comparison graphs are serialized. The following values are supported:</p>
</li>
<li>
<p><code>"application/json"</code></p>
</li>
<li><code>"application/ld+json"</code></li>
<li><code>"application/n-quads"</code></li>
<li><code>"application/n-triples"</code></li>
<li><code>"application/rdf+xml"</code></li>
<li><code>"application/trig"</code></li>
<li><code>"text/html"</code></li>
<li><code>"text/n3";</code></li>
<li>
<p><code>"text/turtle"</code></p>
</li>
<li>
<p><code>defaultGraph</code> specifies the named graph in which the comparison graph must be loaded. This is only useful if the chosen RDF serialization format cannot express named graphs.</p>
</li>
<li>
<p><code>key</code> unknown</p>
</li>
</ul>
<h2 id="see-also">See also<a class="headerlink" href="#see-also" title="Permanent link">¶</a></h2>
<p>Graph comparison makes use of graph isomorphism, which is part of the RDF 1.1 Semantics standard (<a href="https://www.w3.org/TR/rdf11-mt/">external link</a>).</p>
<!--
## A complete example

We use the following full TriplyETL script to explain the validation feature.  Do not be afraid by the length of the script; we will go through each part step-by-step.


<pre><code class="language-ts">import { compareGraphs, declarePrefix, Etl, fromJson,
         Source } from '@triplyetl/etl/generic'
import { iri, pairs } from '@triplyetl/etl/ratt'
import { qudt, rdf, unit } from '@triplyetl/vocabularies'

const base = declarePrefix('https://example.com/')
const prefix = {
  graph: declarePrefix(base('id/graph/')),
  skolem: declarePrefix(base('.well-known/genid/')),
}

export default async function (): Promise&lt;Etl&gt; {
  const etl = new Etl({ defaultGraph: prefix.graph('instances') })
  etl.use(
    fromJson([{ id: '1', height: 15 }]),
    pairs(iri(prefix.skolem, 'id'),
      [qudt.unit, unit.CentiM],
      [rdf.value, 'height'],
    ),
    compareGraphs(Source.file('product-1.trig')),
  )
  return etl
}
</code></pre>


### Step 1: Identify representative records

Select a limited number of records from your data sources that together are representative for the full data source systems.

This often includes typical records where the expected data items are included, as well as atypical records that are 'outliers'.

There must be reasonable confidence that a TriplyETL pipeline that produces the correct results for these selected records is likely to produce correct results for all records.


### Step 2: Manually create linked data

Create an RDF file for every representative record.  The file must contain the linked data that should be generated for that specific record.  It is probably best to use the TriG format for this, but all RDF formats are supported.

For our example, we create a file called `product-1.trig` with the following content:


<pre><code class="language-turtle">prefix graph: &lt;https://example.com/id/graph/&gt;
prefix qudt: &lt;http://qudt.org/schema/qudt/&gt;
prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;
prefix unit: &lt;http://qudt.org/vocab/unit/&gt;

graph:instances {
  []
    qudt:unit unit:CentiM;
    rdf:value 15.
}
</code></pre>



### Step 3: Create the ETL

Write the TriplyETL configuration.  In our example we start with the prefix declarations:


<pre><code class="language-ts">const base = declarePrefix('https://example.com/')
const prefix = {
  graph: declarePrefix(base('id/graph/')),
  skolem: declarePrefix(base('.well-known/genid/')),
}
</code></pre>


We use the following extractor:


<pre><code class="language-ts">fromJson([{ id: '1', height: 15 }]),
</code></pre>


And we use the following assertions:


<pre><code class="language-ts">pairs(iri(prefix.skolem, 'id'),
  [qudt.unit, unit.CentiM],
  [rdf.value, 'height'],
),
</code></pre>


### Step 4. Perform graph comparison

In our example, we only generate linked data for one record, so we can trivially compare the results for that one record with the manually created RDF that is stored in the local file:


<pre><code class="language-ts">compareGraphs(Source.file('product-1.trig')),
</code></pre>


In more complex pipleines you may need to determine the local file based on the data.  For example, check whether the value for key `id` in the record corresponds to a local file called `product-ID.trig`.

If the generated graph differs in any meaningful way from the RDF stored in the local file, and error is emitted and the TriplyETL pipeline is interrupted.
-->
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../" title="Overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../shacl/" title="SHACL">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../shacl/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script>var base_url = '../../..';</script>
<script defer="" src="../../../js/triply.js"></script>
<script defer="" src="../../../js/highlight.min.js"></script>
<script defer="" src="../../../search/main.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@10.4.0/dist/mermaid.esm.min.mjs";
mermaid.initialize({});</script></body>
</html>
